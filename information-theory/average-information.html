<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>平均情報量（エントロピー）</title>
        <link rel="stylesheet" href="../css/style.css">
        <script src="../js/mathjax.js"></script>
    </head>
    <body>
        <header id="header"></header>
        <aside id="sidebar"></aside>
        <main id="contents">
            <h1>平均情報量（エントロピー）</h1>
            <div id="table-of-contents"></div>
            <section id="1">
                <h2>平均情報量の定義</h2>
                <p class="indent">
                    情報量の期待値を<strong>平均情報量（エントロピー）</strong>といい、次のように定義されます。
                </p>
                <figure class="def">
                    <figcaption>定義（平均情報量）</figcaption>
                    <p class="indent">
                        確率変数 \(X\) に対して
                    </p>
                    <div class="math">
                        \[
                        H(X)=E[I(X)] \quad [\mathrm{bit}]
                        \]
                    </div>
                    <p>
                        を \(X\) の<strong>平均情報量（エントロピー）</strong>という。
                    </p>
                </figure>
                <p>
                    \(X\) が離散型確率変数の場合、確率質量関数 \(p(x)\) によって
                </p>
                <div class="math">
                    \[
                    H(X)=\sum_{x}p(x)I(x)=-\sum_{x}p(x)\log p(x)
                    \]
                </div>
                <p>
                    \(X\) が連続型確率変数の場合、確率密度関数 \(p(x)\) によって
                </p>
                <div class="math">
                    \[
                    H(X)=\int_{X}p(x)I(x)dx=-\int_{X}p(x)\log p(x)dx
                    \]
                </div>
                <p>
                    となります。
                </p>
                <figure class="ex-problem">
                    <figcaption>例題</figcaption>
                    <p class="indent">
                        ある地域では、年間、晴れの日は200日、雨の日は60日、雪の日は5日である。
                        この天気の平均情報量を求めよ。（小数第2位まで）
                    </p>
                </figure>
                <p>
                    天気を \(X\) とすると
                </p>
                <div class="math">
                    \[
                    \begin{align}
                    H(X)&=E[I(X)] \\
                    &=\sum_{x}p(x)I(x) \\
                    &=-\sum_{x}p(x)\log_2p(x) \\
                    &=-\frac{200}{365}\log_2\frac{200}{365}-\frac{60}{365}\log_2\frac{60}{365}-\frac{5}{365}\log_2\frac{5}{365}
                    \end{align}
                    \]
                </div>
            </section>
            <section id="2">
                <h2>エントロピー関数</h2>
                <p class="indent">
                    2値をとる確率変数 \(X\in\{x_1,x_2\}\) を考え、確率質量関数を
                </p>
                <div class="math">
                    \[
                    p(x)=
                    \begin{cases}
                    p & (x=x_1) \\
                    1-p & (x=x_2)
                    \end{cases}
                    \quad (p\in[0,1])
                    \]
                </div>
                <p>
                    とします。
                    このとき \(X\) のエントロピーは
                </p>
                <div class="math">
                    \[
                    \begin{align}
                    H(X)&=-\sum_{x}p(x)\log_2p(x) \\
                    &=-p(x_1)\log_2p(x_1)-p(x_2)\log_2p(x_2) \\
                    &=-p\log_2p-(1-p)\log_2(1-p)
                    \end{align}
                    \]
                </div>
                <p>
                    となり、これは \(p\) の1変数関数と見ることができます。
                    この関数を<strong>エントロピー関数</strong>といい、次のように定義されます。
                </p>
                <figure class="def">
                    <figcaption>定義（エントロピー関数）</figcaption>
                    <p class="indent">
                        確率 \(p\in[0,1]\) に対して
                    </p>
                    <div class="math">
                        \[
                        \mathcal{H}(p):=-p\log_2p-(1-p)\log_2(1-p)
                        \]
                    </div>
                    <p>
                        を<strong>エントロピー関数</strong>という。
                    </p>
                </figure>
            </section>
            <section id="3">
                <h2>最大エントロピー</h2>
                <p class="indent">
                    エントロピー関数
                </p>
                <div class="math">
                    \[
                    \mathcal{H}(p)=-p\log_2p-(1-p)\log_2(1-p)
                    \]
                </div>
                <p>
                    の最大値を考えます。
                </p>
                <p class="indent">
                    \(\mathcal{H}(p)\) を \(p\) で微分すると
                </p>
                <div class="math">
                    \[
                    \begin{align}
                    \frac{d\mathcal{H}}{dp}
                    &=-\log_2p-\frac{1}{\log2}+\log_2(1-p)+\frac{1}{\log2}\\
                    &=-\log_2p+\log_2(1-p)
                    \end{align}
                    \]
                </div>
                <p>
                    よって
                </p>
                <div class="math">
                    \[
                    \begin{align}
                    \frac{d\mathcal{H}}{dp}=0&\Longleftrightarrow\log_2p=\log_2(1-p)\\
                    &\Longleftrightarrow p=1-p\\
                    &\Longleftrightarrow p=\frac{1}{2}
                    \end{align}
                    \]
                </div>
                <p>
                    このとき、増減表は次のようになります。
                </p>
                <table>
                    <tr><td>\(p\)</td><td>\(0\)</td><td>\(\cdots\)</td><td>\(\displaystyle\frac{1}{2}\)</td><td>\(\cdots\)</td><td>\(1\)</td></tr>
                    <tr><td>\(\dfrac{d\mathcal{H}}{dp}\)</td><td></td><td>\(+\)</td><td>\(0\)</td><td>\(-\)</td><td></td></tr>
                    <tr><td>\(H\)</td><td>\(0\)</td><td>↗</td><td>\(1\)</td><td>↘</td><td>\(0\)</td></tr>
                </table>
                <p class="indent">
                    したがって、\(\mathcal{H}(p)\) は \(p=\displaystyle\frac{1}{2}\) で最大値 \(1\) をとります。
                    つまり、エントロピーが最大になるのは、事象が等確率で現れるときです。
                </p>
                <p class="indent">
                    一般に、\(n\) 元事象系のエントロピーが最大となるのは、\(n\) 個の事象の生起確率が等確率で \(\displaystyle\frac{1}{n}\) であるときです。
                </p>
                <figure class="th">
                    <figcaption>定理（最大エントロピー）</figcaption>
                    <p class="indent">
                        \(n\) 元事象系の最大エントロピー \(H_{\mathrm{max}}\) は
                    </p>
                    <div class="math">
                        \[
                        H_{\mathrm{max}}=-\log_2\frac{1}{n}=\log_2n
                        \]
                    </div>
                    <p>
                        で与えられる。
                    </p>
                </figure>
            </section>
            <section id="ex">
                <h2>演習問題</h2>
                <figure class="ex-practice">
                    <figcaption>問題</figcaption>
                    <p class="indent">
                        表が出る確率が \(\displaystyle\frac{1}{4}\) であるコインがある。
                        このコインを投げたとき、表が出る事象を \(H\) 、裏が出る事象を \(T\) とする。
                        次の問いに答えよ。
                    </p>
                    <ol>
                        <li>コインを投げたときの結果の事象系 \(X\) を表せ。</li>
                        <li>
                            エントロピー \(H(X)\) を求めよ。
                            ただし、\(\log_23=1.585\) とする。
                        </li>
                    </ol>
                </figure>
                <details class="ans">
                    <summary>解答</summary>
                    <ol>
                        <li>
                            <div class="math">
                                \(
                                \displaystyle X=\begin{bmatrix} H & T \\ \frac{1}{4} & \frac{3}{4} \end{bmatrix}
                                \)
                            </div>
                        </li>
                        <li>
                            <div class="math">
                                \(
                                \begin{align}
                                H(X)&=-\sum_{x\in X}P(x)\log_2P(x)\\
                                &=-P(H)\log_2P(H)-P(T)\log_2P(T)\\
                                &=-\frac{1}{4}\log_2\frac{1}{4}-\frac{3}{4}\log_2\frac{3}{4}\\
                                &=\frac{1}{4}\log_24+\frac{3}{4}\log_24-\frac{3}{4}\log_23\\
                                &=\frac{1}{2}+\frac{3}{2}-\frac{3}{4}\cdot1.585\\
                                &=0.81125
                                \end{align}
                                \)
                            </div>
                        </li>
                    </ol>
                </details>
            </section>
            
        </main>
        <footer id="footer"></footer>
        <script src="../js/header.js"></script>
        <script src="../js/sidebar.js"></script>
        <script src="../js/footer.js"></script>
        <script src="../js/script.js"></script>
    </body>
</html>