<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>結合エントロピーと条件付きエントロピー</title>
        <link rel="stylesheet" href="../css/style.css">
        <script src="../js/mathjax.js"></script>
    </head>
    <body>
        <header id="header"></header>
        <aside id="sidebar"></aside>
        <main id="contents">
            <h1>結合エントロピーと条件付きエントロピー</h1>
            <div id="table-of-contents"></div>
            <section id="1">
                <h2>結合エントロピー</h2>
                <p class="indent">
                    <strong>結合エントロピー</strong>は、2つの確率変数 \(X,Y\) に対して定義され、\(X\) と \(Y\) を同時に知らないときの不確実性を表す量です。
                </p>
                <figure class="def">
                    <figcaption>定義（結合エントロピー）</figcaption>
                    <p class="indent">
                        2つの確率変数 \(X,Y\) に対して
                    </p>
                    <div class="math">
                        \[
                        p(x,y)=P(X=x,~Y=y)
                        \]
                    </div>
                    <p>
                        とするとき
                    </p>
                    <div class="math">
                        \[
                        H(X,Y)=-\sum_{x}\sum_{y}p(x,y)\log_2p(x,y)
                        \]
                    </div>
                    <p>
                        を \(X\) と \(Y\) の<strong>結合エントロピー</strong>という。
                    </p>
                </figure>
            </section>
            <section id="2">
                <h2>条件付きエントロピー</h2>
                <p class="indent">
                    2つの確率変数 \(X,Y\) があり、\(X=x\) とわかっているときの \(Y\) のエントロピー
                </p>
                <div class="math">
                    \[
                    H(Y \mid X=x)=-\sum_{y}p(y \mid x)\log_2p(y \mid x)
                    \]
                </div>
                <p>
                    を考えます。
                    ただし、\(p(y \mid x)=P(Y \mid X=x)\) です。
                    このエントロピー \(H(Y \mid X=x)\) は \(x\) の値によるため、\(x\) について平均化すると
                </p>
                <div class="math">
                    \[
                    \begin{align}
                    &\sum_xp(x)H(Y \mid X=x)\\
                    &=-\sum_xp(x)\sum_{y}p(y \mid x)\log_2p(y \mid x) \\
                    &=-\sum_x\sum_{y}p(x)p(y \mid x)\log_2p(y \mid x) \\
                    &=-\sum_x\sum_{y}p(x,y)\log_2p(y \mid x)
                    \end{align}
                    \]
                </div>
                <p>
                    が得られます。
                    これを<strong>条件付きエントロピー</strong>といい、次のように定義されます。
                </p>
                <figure class="def">
                    <figcaption>定義（条件付きエントロピー）</figcaption>
                    <p class="indent">
                        2つの確率変数 \(X,Y\) に対して
                    </p>
                    <div class="math">
                        \[
                        p(x,y)=P(X=x,~Y=y)
                        \]
                        \[
                        p(y \mid x)=P(Y=y \mid X=x)
                        \]
                    </div>
                    <p>
                        とするとき
                    </p>
                    <div class="math">
                        \[
                        H(Y \mid X)=-\sum_{x}p(x,y)\log_2p(y \mid x)
                        \]
                    </div>
                    <p>
                        を \(X\) の元での \(Y\) の<strong>条件付きエントロピー</strong>という。
                    </p>
                </figure>
            </section>
            <section id="3">
                <h2>例題</h2>
                <figure class="ex-problem">
                    <figcaption>例題</figcaption>
                    <p class="indent">
                        曜日に関する事象系を \(A\) 、外食の有無に関する事象系を \(B\) とし
                    </p>
                    <div class="math">
                        \[
                        A=\{\text{平日},~\text{休日}\},~~~B=\{\text{外食},~\text{内食}\}
                        \]
                    </div>
                    <p>
                        とする。
                        ある人の外食習慣を調べたところ、次のことがわかった。
                    </p>
                    <ul>
                        <li>平日に外食する確率は \(0.1\)</li>
                        <li>平日に外食しない確率は \(0.6\)</li>
                        <li>休日に外食する確率は \(0.2\)</li>
                        <li>休日に外食しない確率は \(0.1\)</li>
                    </ul>
                    <p>
                        このとき、以下の問いに答えよ。
                    </p>
                    <ol>
                        <li>結合エントロピー \(H(AB)\) を求めよ。</li>
                        <li>条件付きエントロピー \(H(B|A)\) を求めよ。</li>
                        <li>条件付きエントロピー \(H(A|B)\) を求めよ。</li>
                    </ol>
                </figure>
                <ol>
                    <li>
                        まず、結合事象系は次のようになります。
                        \[
                        AB=
                        \begin{bmatrix}
                        (\text{平日},~\text{外食}) & (\text{平日},~\text{内食}) & (\text{休日},~\text{外食}) & (\text{休日},~\text{内食})\\
                        0.1 & 0.6 & 0.2 & 0.1\\
                        \end{bmatrix}
                        \]
                        よって
                        \[
                        \begin{align}
                        H(AB)&=-0.1\log_2{0.1}-0.6\log_2{0.6}-0.2\log_2{0.2}-0.1\log_2{0.1}\\
                        &=1.57~\mathrm{bit}
                        \end{align}
                        \]
                    </li>
                </ol>
            </section>
            <section id="ex">
                <h2>演習問題</h2>
                <figure class="ex-practice">
                    <figcaption>問題</figcaption>

                </figure>
            </section>
        </main>
        <footer id="footer"></footer>
        <script src="../js/header.js"></script>
        <script src="../js/sidebar.js"></script>
        <script src="../js/footer.js"></script>
        <script src="../js/script.js"></script>
    </body>
</html>