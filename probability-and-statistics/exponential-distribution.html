<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>指数分布</title>
        <link rel="stylesheet" href="../css/style.css">
        <script src="../js/mathjax-config.js"></script>
        <script src="../mathjax/es5/tex-mml-chtml.js"></script>
    </head>
    <body>
        <header id="header"></header>
        <main id="contents">
            <h1>指数分布</h1>
            <div id="table-of-contents"></div>
            <section id="1">
                <h2>指数分布の定義</h2>        
                <p class="indent">
                    単位時間に平均 \(\lambda\) 回起こる事象が、\(x\) 単位時間の間隔で起こる確率を表す確率分布です。
                    ある事象がランダムに起こるとき、その次に事象が起こるまでの待ち時間が従う確率分布です。
                </p>
                <p>
                    \(X\) を「次に事象が起こるまでの時間」とします。
                </p>
                <p>
                    ・事象は一定の割合 \(\lambda\) （単位時間あたり）で起こる <br>
                    ・事象が起こる確率は過去に起きたかどうかに関係しない
                </p>
                <p>
                    \(X\) の確率分布を求めたいので、まず累積分布関数 \(F(x)\) を考えます。確率密度関数は
                </p>
                <div class="math">
                    \[
                    f(x)=\frac{d}{dx}F(x)
                    \]
                </div>
                <p>
                    の関係から得られます。
                </p>
                <p>
                    累積分布関数とは
                </p>
                <div class="math">
                    \[
                    F(x)=P(X\le x)
                    \]
                </div>
                <p>
                    と定義される関数でした。これは
                </p>
                <p class="center">
                    「\(X\) が \(x\) 以下である確率」
                </p>
                <p>
                    つまり
                </p>
                <p class="center">
                    「時間 \(x\) 以内で次の事象が起こる確率」
                </p>
                <p>
                    を表しています。
                </p>
                <p>
                    この場合、「時間 \(x\) ではまだ起きていない確率」の方が考えやすいです。時間 \(x\) ではまだ起きていない確率を \(G(x)\) とすると
                </p>
                <div class="math">
                    \[
                    F(x)=P(X\le x)=1-G(x)
                    \]
                </div>
                <p>
                    となります。
                </p>
                <p class="indent">
                    ここでは、まずこの \(G(x)\) を求めます。
                </p>
                <p>
                    時間 \(x+\varDelta x\) の時点でまだ起きていない確率は、<br>
                   「時間 \(x\) まで起きていない」確率と、<br>
                    「そこからさらに時間 \(\varDelta x\) 後でも起きていない」確率の積と考えられます。
                </p>
                <div class="math">
                    \[
                    G(x+\varDelta x)=G(x)(1-\lambda\varDelta x)
                    \]
                </div>
                <p>
                    これを整理して
                </p>
                <div class="math">
                    \[
                    \frac{G(x+\varDelta x)-G(x)}{\varDelta x}=-\lambda G(x)
                    \]
                </div>
                <p>
                    とし、\(\varDelta x\to0\) の極限をとると
                </p>
                <div class="math">
                    \[
                    \frac{dG(x)}{dx}=-\lambda G(x)
                    \]
                </div>
                <p>
                    という微分方程式が得られます。これの一般解は
                </p>
                <div class="math">
                    \[
                    G(x)=Ce^{-\lambda x}
                    \]
                </div>
                <p>
                    です。初期条件 \(G(0)=1\)（時間0ではまだ何も起きていない）より \(C=1\) となり
                </p>
                <div class="math">
                    \[
                    G(x)=e^{-\lambda x}
                    \]
                </div>
                <p>
                    とわかりました。
                </p>
                <p class="indent">
                    よって、累積分布関数は
                </p>
                <div class="math">
                    \[
                    F(x)=1-G(x)=1-e^{-\lambda x}
                    \]
                </div>
                <p>
                    となります。
                </p>
                <p class="indent">
                    これを微分すれば、確率密度関数が得られます：
                </p>
                <div class="math">
                    \[
                    f(x)=\frac{dF(x)}{dx}=\lambda e^{-\lambda x}
                    \]
                </div>
                <p>
                    これを指数分布といい、次のように定義されます。
                </p>
                <figure class="def">
                    <figcaption>定義（指数分布）</figcaption>
                    <p>
                        連続型確率変数 \(X\) の確率密度関数 \(f\) が、\(\lambda\gt0\) として
                    </p>
                    <div class="math">
                        \[
                        f(x)=
                        \begin{cases}
                        \lambda e^{-\lambda x} & (\mathrm{if}~x\gt0)\\
                        0 & (\mathrm{otherwise})
                        \end{cases}
                        \]
                    </div>
                    <p>
                        であるとき、\(X\) はパラメータ \(\lambda\) の指数分布に従うといい
                    </p>
                    <div class="math">
                        \[
                        X\sim Ex(\lambda)
                        \]
                    </div>
                    <p>
                        と表す。
                    </p>
                </figure>
            </section>
            <section id="2">
                <h2>指数分布に従う確率変数の期待値と分散</h2>
                <div class="th">
                    <div>定理（指数分布に従う確率変数の期待値と分散）</div>
                    \(X\sim Ex(\lambda)\) のとき
                    \[
                    E[X]=\frac{1}{\lambda},~~~~~V[X]=\frac{1}{\lambda^2}
                    \]
                </div>
                <details class="pf">
                    <summary>証明</summary>
                    <div>
                        \[
                        \begin{align}
                        E[X]
                        &=\int_{-\infty}^\infty xf(x)dx\\
                        &=\int_0^\infty x\cdot\lambda e^{-\lambda x}dx\\
                        &=\int_0^\infty x\left(-e^{-\lambda x}\right)'dx\\
                        &=\left[-xe^{-\lambda x}\right]_0^\infty+\int_0^\infty e^{-\lambda x}dx\\
                        &=\left[-\frac{1}{\lambda}e^{-\lambda x}\right]_0^\infty\\
                        &=\frac{1}{\lambda}
                        \end{align}
                        \]
                        <p></p>
                        \[
                        \begin{align}
                        V[X]
                        &=E[X^2]-E[X]^2\\
                        &=\int_{-\infty}^\infty x^2f(x)dx-\frac{1}{\lambda^2}\\
                        &=\int_0^\infty x^2\cdot\lambda e^{-\lambda x}dx-\frac{1}{\lambda^2}\\
                        &=\int_0^\infty x^2\left(-e^{-\lambda x}\right)'dx-\frac{1}{\lambda^2}\\
                        &=\left[-x^2e^{-\lambda x}\right]_0^\infty+\int_0^\infty 2xe^{-\lambda x}dx-\frac{1}{\lambda^2}\\
                        &=\int_0^\infty2x\left(-\frac{1}{\lambda}e^{-\lambda x}\right)'dx-\frac{1}{\lambda^2}\\
                        &=\left[-\frac{2}{\lambda}xe^{-\lambda x}\right]_0^\infty+\int_0^\infty\frac{2}{\lambda}e^{-\lambda x}dx-\frac{1}{\lambda^2}\\
                        &=\left[-\frac{2}{\lambda^2}e^{-\lambda x}\right]_0^\infty-\frac{1}{\lambda^2}\\
                        &=\frac{2}{\lambda^2}-\frac{1}{\lambda^2}\\
                        &=\frac{1}{\lambda^2}
                        \end{align}
                        \]
                    </div>
                </details>
            </section>
            <section id="3">
                <h2>指数分布に従う具体例</h2>
                <figure class="ex-problem">
                    <figcaption>例題</figcaption>
                    <p class="indent">
                        1時間に平均20人が来店する飲食店がある。この飲食店にある客が来てから次の客が5分以内に来店する確率を求めよ。
                    </p>
                </figure>
                <p class="indent">
                    客の来店間隔を \(X\) 時間とします。<br>
                    \(X\sim Ex(20)\) であるから \(X\) の確率密度関数は
                </p>
                <div class="math">
                    \[
                    f(x)=20e^{-20x}~~~(x\gt0)
                    \]
                </div>
                <p>
                    です。また、
                </p>
                <div class="math">
                    \[
                    5\text{分}=\frac{5}{60}\text{時間}=\frac{1}{12}\text{時間}
                    \]
                </div>
                <p>
                    なので、求める確率は
                </p>
                <div class="math">
                    \[
                    \begin{align}
                    P\left(0\lt X\le\frac{1}{12}\right)
                    &=\int_0^{\frac{1}{12}}20e^{-20x}dx\\
                    &=\left[-e^{-20x}\right]_0^\frac{1}{12}\\
                    &=1-e^{-\frac{5}{3}}\\
                    &\fallingdotseq1-0.189\\
                    &=0.811
                    \end{align}
                    \]
                </div>
            </section>
            <section id="4">
                <h2>指数分布の無記憶性</h2>
                <figure class="th">
                    <figcaption>定理（指数分布の無記憶性）</figcaption>
                    <p>
                        \(X\sim Ex(\lambda)\) とし、\(s,t\in\mathbb{R}_{\ge0}\) とすると次式が成り立つ。
                    </p>
                    <div class="math">
                        \[
                        P(X\gt s+t~|~X\gt s)=P(X\gt t)
                        \]
                    </div>
                </figure>
                <details class="pf">
                    <summary>証明</summary>
                    <div class="math">
                        \[
                        \begin{align}
                        P(X\gt s+t~|~X\gt s)
                        &=\frac{P(\{X\gt s+t\}\land\{X\gt s\})}{P(X\gt s)}\\
                        &=\frac{P(X\gt s+t)}{P(X\gt s)}\\
                        &=\frac{\displaystyle\int_{s+t}^\infty\lambda e^{-\lambda x}dx}{\displaystyle\int_{s}^\infty\lambda e^{-\lambda x}dx}=\frac{\left[-e^{-\lambda x}\right]_{s+t}^\infty}{\left[-e^{-\lambda x}\right]_{s}^\infty}\\
                        &=\frac{e^{-\lambda(s+t)}}{e^{-\lambda s}}=e^{-\lambda t}
                        \end{align}
                        \]
                        \[
                        P(X\gt t)=\int_{t}^\infty\lambda e^{-\lambda x}dx=\left[-e^{-\lambda x}\right]_t^\infty=e^{-\lambda t}
                        \]
                    </div>
                    <p>
                        したがって
                    </p>
                    <div class="math">
                        \[
                        P(X\gt s+t~|~X\gt s)=P(X\gt t)
                        \]
                    </div>                    
                </details>
                <p>
                    無記憶性を持つ確率分布は指数分布のみです。
                </p>
            </section>
            <section id="ex">
                <h2>演習問題</h2>
                <div class="ex">
                    <div>問題</div>
                    
                </div>
                <details class="ans">
                    <summary>解答</summary>
                    <div>
                        
                    </div>
                </details>
            </section>
        </main>
        <footer id="footer"></footer>
        <script src="../js/header.js"></script>
        <script src="../js/footer.js"></script>
        <script src="../js/script.js"></script>
    </body>
</html>