<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>仮説検定</title>
        <link rel="stylesheet" href="../css/style.css">
        <script src="../js/mathjax.js"></script> 
    </head>
    <body>
        <header id="header"></header>
        <main id="contents">
            <h1>仮説検定</h1>
            <div id="table-of-contents"></div>
            <section id="1">
                <h2>仮説検定とは</h2>
                <p class="indent">
                    標本調査により得られたデータから仮説の真偽を判定する方法を<strong>仮説検定</strong>といいます。
                    以下にその手順を示します。
                </p>
                <p>
                    １枚のコインがあります。
                    このコインを投げたとき、表が出る確率が \(\dfrac{1}{2}\) である正常なコインかどうか調べたいとします。
                </p>
                <section>
                    <h3>仮説を定める</h3>
                    <p class="indent">
                        検定の対象となる母数 \(\theta\) が特定の値 \(\theta_0\) であるという仮説を
                    </p>
                    <div class="math">
                        \[
                        H_0:\theta=\theta_0
                        \]
                    </div>
                    <p>
                        と表し、この仮説 \(H_0\) を<strong>帰無仮説</strong>といいます。
                        この \(H_0\) が実験者が否定したい仮説です。
                    </p>
                    <p class="indent">
                        帰無仮説 \(H_0\) が正しくないことを主張するための仮説 \(H_1\) を<strong>対立仮説</strong>といいます。
                        対立仮説としては、以下の３種類が考えられます。
                    </p>
                    <ul>
                        <li><p>\(H_1:\theta\neq\theta_0\) （両側検定）</p></li>
                        <li><p>\(H_1:\theta\gt\theta_0\) （右側検定）</p></li>
                        <li><p>\(H_1:\theta\lt\theta_0\) （左側検定）</p></li>
                    </ul>
                    <p class="indent">
                        仮説検定は、まず帰無仮説 \(H_0\) が正しいと仮定します。
                        そのまま議論を進めたとき、その状況は確率的にあり得ないとなれば、\(H_0\) が間違っていたと判断し、\(H_1\) が正しいとする、という流れです。
                    </p>
                </section>
                <section>
                    <h3>有意水準を定める</h3>
                    <p class="indent">
                        帰無仮説 \(H_0\) が本当は正しいのに、\(H_0\) が誤りだと判断してしまう確率を<strong>有意水準（危険率）</strong>といい、\(\alpha\) で表します。
                        この \(\alpha\) の値は事前に定めます。一般的に \(\alpha=0.05~~(5\%)\) 、\(\alpha=0.01~~(1\%)\) とすることが多いです。
                    </p>
                </section>
                <section>
                    <h3>検定統計量を選び、分布から棄却域を求める</h3>
                    <p class="indent">
                        母集団から \(n\) 個の無作為標本 \(X_1,X_2,\cdots,X_{n}\) を抽出します。
                        この無作為標本に対して、確率分布がわかる適当な統計量
                    </p>
                    <div class="math">
                        \[
                        T(X_1,X_2,\cdots,X_n)
                        \]
                    </div>
                    <p>
                        を選びます。検定に用いる統計量を<strong>検定統計量</strong>といいます。
                    </p>
                    <p class="indent">
                        帰無仮説 \(H_0\) が正しいと仮定した上で、検定統計量 \(T\) が従う分布を決定します。
                        \(T\) の確率密度関数 \(f_T(t)\) のグラフを用いて、対立仮説 \(H_1\) の定め方に応じて、有意水準 \(\alpha\) をもとに、下図のように <strong>棄却域</strong> \(R\) を求めます。
                    </p>
                </section>
                <section>
                    <h3>帰無仮説が棄却されるか判断する</h3>
                    <p class="indent">
                        無作為標本 \(X_1,X_2,\cdots,X_{n}\) の実現値 \(x_1,x_2,\cdots,x_n\) を用いて、検定統計量 \(T\) の実現値
                    </p>
                    <div class="math">
                        \[
                        t_0=T(x_1,x_2,\cdots,x_n)
                        \]
                    </div>
                    <p>
                        を求めます。
                        この値が棄却域 \(R\) に含まれるか調べます。
                        棄却域 \(R\) に入るということは、それだけ珍しい値である（怪しい）ということです。
                        したがって
                    </p>
                    <div class="math">
                        \[
                        t_0\in R
                        \]
                    </div>
                    <p>
                        であれば \(H_0\) は棄却されます。
                        反対に
                    </p>
                    <div class="math">
                        \[
                        t_0\notin R
                        \]
                    </div>
                    <p>
                        であれば \(H_0\) は棄却されません。
                    </p>
                    <p class="indent">
                        帰無仮説 \(H_0\) が棄却されると、対立仮説 \(H_1\) を採択します。
                        よってこの場合、\(H_1\) が正しいと結論づけられます。
                    </p>
                </section>
                <section>
                    <h3>仮説検定の流れのまとめ</h3>
                    <figure class="box">
                        <figcaption>仮説検定の流れ</figcaption>
                        <ol>
                            <li>帰無仮説と対立仮説を定めて、帰無仮説が正しいと仮定する</li>
                            <li>有意水準を定める</li>
                            <li>検定統計量を選び、その分布から棄却域を求める</li>
                            <li>検定統計量の実現値が棄却域に含まれるかを判断する</li>
                        </ol>
                    </figure>
                </section>
            </section>
            <section id="2">
                <h2>第１種の過誤と第２種の過誤</h2>
                <p class="indent">
                    仮説検定は、あくまで統計学的判断なので、間違った結論を出してしまうことがあります。
                    この間違った結論には、以下の２種類があります。
                </p>
                <figure class="box">
                    <figcaption>第１種の過誤</figcaption>
                    <p>帰無仮説 \(H_0\) が本当は正しいのにそれを棄却する誤り</p>
                </figure>
                <p class="indent">
                    有意水準 \(\alpha\) がこの過誤を犯す確率を表しています。
                    この \(\alpha\) の値を小さく設定すれば、第１種の過誤が起こる確率を小さくできます。
                </p>
                <figure class="box">
                    <figcaption>第２種の過誤</figcaption>
                    <p>帰無仮説 \(H_0\) が本当は正しくないのにそれを棄却しない誤り</p>
                </figure>
                <p class="indent">
                    第２種の過誤を犯す確率は \(\beta\) で表す。
                    この \(\beta\) は未知の母数に依存するため、分析者がこの値を事前に知ることはできません。
                    そのため、分析者は主張したい仮説を対立仮説 \(H_1\) に設定し、帰無仮説 \(H_0\) が棄却されることを通じて、\(H_1\) を示すのが一般的です。
                    また、第２種の過誤を犯さない確率は \(1-\beta\) と表され、これを<strong>検出力</strong>といいます。
                </p>
                <p class="indent">
                    仮説検定を行う際は、\(\alpha,\beta\) が共に小さい方がもちろんいいのですが、片方を小さくするともう片方は大きくなる関係があります。
                </p>
            </section>
            <section id="4">
                <h2>p値法</h2>
                <p class="indent">
                    次のように定義される量を<strong>p値</strong>といいます。
                </p>
                <figure class="def">
                    <figcaption>定義（p値）</figcaption>
                    <p class="indent">
                        帰無仮説 \(H_0\) のもとで、観測された検定統計量以上に極端な値が得られる確率を<strong>p値</strong>といいます。
                    </p>
                    <div class="math">
                        \[
                        p=P(T\ge t_0~|~H_0)
                        \]
                    </div>
                </figure>
                <p class="indent">
                    p値が求まるのなら、より簡単に帰無仮説 \(H_0\) を棄却するかどうかを判断することができます。
                </p>
            </section>
        </main>
        <footer id="footer"></footer>
        <script src="../js/header.js"></script>
        <script src="../js/footer.js"></script>
        <script src="../js/script.js"></script>
    </body>
</html>