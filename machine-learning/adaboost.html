<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>AdaBoost</title>
        <link rel="stylesheet" href="../css/style.css">
        <script src="../js/mathjax.js"></script>
    </head>
    <body>
        <header id="header"></header>
        <aside id="sidebar"></aside>
        <main id="contents">
            <h1>AdaBoost</h1>
            <div id="table-of-contents"></div>
            <section id="1">
                <h2>AdaBoostの概要</h2>
                <p class="indent">
                    <strong>AdaBoost</strong>は、弱学習器を直列につなげ、前の分類器で誤分類されたデータの重みを大きくして次の分類器を作ることで、最終的に高性能な強学習器を生成するアンサンブル学習のアルゴリズムです。
                    Adaは英語のAdaptive「適応的」を意味します。
                </p>
                <p class="indent">
                    AdaBoostの学習アルゴリズムは次の通りです。
                </p>
                <figure class="th">
                    <figcaption>アルゴリズム（AdaBoost）</figcaption>
                    <p class="indent">
                        次のような2値分類のデータセットを考える。
                    </p>
                    <div class="math">
                        \[
                        \{(\boldsymbol{x}_i,y_i) \mid \boldsymbol{x}_i\in\mathbb{R}^d,~y_i\in\{1,-1\}\}_{i=1}^N
                        \]
                    </div>
                    <p class="indent">
                        各データ \(\boldsymbol{x}_i\) の重みを初期化する。
                    </p>
                    <div class="math">
                        \[
                        w_i^{(1)}=\frac{1}{N} \quad (i=1,\cdots,N)
                        \]
                    </div>
                    <p class="indent">
                        以下の操作を \(m=1,2\cdots,M\) で繰り返す。
                    </p>
                    <ol>
                        <li>
                            弱学習器 \(f_m(\boldsymbol{x})\) を学習する。
                            <div class="math">
                                \[
                                f_m(\boldsymbol{x})=\operatorname*{arg min\;}_{f(\boldsymbol{x})}\sum_{i=1}^Nw_i^{(m)}1(y_i\neq f(\boldsymbol{x}_i))
                                \]
                            </div>
                        </li>
                        <li>
                            弱学習器 \(f_m(\boldsymbol{x})\) の誤判定率を計算する。
                            <div class="math">
                                \[
                                \varepsilon_m=\sum_{i:y_i\neq f_m(\boldsymbol{x}_i)}w_i^{(m)}
                                \]
                            </div>
                        </li>
                        <li>
                            弱学習器 \(f_m(\boldsymbol{x})\) の信頼度を計算する。
                            <div class="math">
                                \[
                                \alpha_m=\frac{1}{2}\log\left(\frac{1-\varepsilon_m}{\varepsilon_m}\right)
                                \]
                            </div>
                        </li>
                        <li>
                            データの重み係数を更新する。
                            <div class="math">
                                \[
                                w_i^{(m+1)}=w_i^{(m)}e^{-\alpha_my_if_m(\boldsymbol{x}_i)} \quad (i=1,\cdots,N)
                                \]
                            </div>
                        </li>
                        <li>
                            データの重みを正規化する。
                            <div class="math">
                                \[
                                w_i^{(m+1)}\gets\frac{w_i^{(m+1)}}{\displaystyle\sum_{j=1}^Nw_j^{(m+1)}} \quad (i=1,\cdots,N)
                                \]
                            </div>
                        </li>
                    </ol>
                    <p class="indent">
                        最終的に次の強学習器を得る。
                    </p>
                    <div class="math">
                        \[
                        F(\boldsymbol{x})=\sum_{m=1}^M\alpha_mf_m(\boldsymbol{x})
                        \]
                    </div>
                    <p class="indent">
                        分類の予測は次のようになる。
                    </p>
                    <div class="math">
                        \[
                        \hat{y}_i=\operatorname{sgn}F(\boldsymbol{x}_i) \quad (i=1,\cdots,N)
                        \]
                    </div>
                </figure>
            </section>
            <section id="2">
                <h2>AdaBoostの理論</h2>
                <p class="indent">
                    AdaBoostの導出を説明します。
                </p>
                <div class="math">
                    \[
                    F_M(\boldsymbol{x})=\sum_{m=1}^M\alpha_mf_m(\boldsymbol{x}_i)
                    \]
                </div>
                <div class="math">
                    \[
                    F_m(\boldsymbol{x})=F_{m-1}(\boldsymbol{x}_i)+\alpha_mf_m(\boldsymbol{x}_i)
                    \]
                </div>
                <p>
                    指数損失により、次の平均損失を損失関数とする。
                </p>
                <div class="math">
                    \[
                    \begin{align}
                    L
                    &=\frac{1}{N}\sum_{i=1}^Ne^{-y_iF_m(\boldsymbol{x}_i)} \\
                    &=\frac{1}{N}\sum_{i=1}^Ne^{-y_i\{F_{m-1}+\alpha_mf_m(\boldsymbol{x}_i)\}} \\
                    &=\frac{1}{N}\sum_{i=1}^Ne^{-y_iF_{m-1}}e^{-y_i\alpha_mf_m(\boldsymbol{x}_i)}
                    \end{align}
                    \]
                </div>
                <p>
                    ここで
                </p>
                <div class="math">
                    \[
                    w_i^{(1)}=\frac{1}{N}, \quad w_i^{(m)}=\frac{1}{N}e^{-y_iF_{m-1}(\boldsymbol{x}_i)}
                    \]
                </div>
                <p>
                    とすると
                </p>
                <div class="math">
                    \[
                    L=\sum_{i=1}^Nw_i^{(m)}e^{-y_i\alpha_mf_m(\boldsymbol{x}_i)}
                    \]
                </div>
                <p>
                    正しく分類できたとき、すなわち \(y_i=f_m(\boldsymbol{x}_i)\) であるとき
                </p>
                <div class="math">
                    \[
                    y_if_m(\boldsymbol{x}_i)=1
                    \]
                </div>
                <p>
                    誤って分類されたとき、すなわち \(y_i \neq f_m(\boldsymbol{x}_i)\) であるとき
                </p>
                <div class="math">
                    \[
                    y_if_m(\boldsymbol{x}_i)=-1
                    \]
                </div>
                <p>
                    となるので、これらで和を分けると
                </p>
                <div class="math">
                    \[
                    \begin{align}
                    L&=\sum_{i=1}^Nw_i^{(m)}e^{-y_i\alpha_mf_m(\boldsymbol{x}_i)} \\
                    &=\sum_{\substack{1\le i\le N \\ y_i=f_m(\boldsymbol{x}_i)}}w_i^{(m)}e^{-\alpha_m} + \sum_{\substack{1\le i\le N \\ y_i\neq f_m(\boldsymbol{x}_i)}}w_i^{(m)}e^{\alpha_m} \\
                    &=(1-\varepsilon)e^{-\alpha_m} + \varepsilon e^{\alpha_m} \\
                    \end{align}
                    \]
                </div>
                <p>
                    このとき
                </p>
                <div class="math">
                    \[
                    \begin{align}
                    &\frac{\partial L}{\partial\alpha_m}=0 \\
                    \\
                    &\Longleftrightarrow -(1-\varepsilon)e^{-\alpha_m} + \varepsilon e^{\alpha_m} = 0 \\
                    \\
                    &\Longleftrightarrow e^{2\alpha_m} = \frac{1-\varepsilon}{\varepsilon} \\
                    \\
                    &\Longleftrightarrow 2\alpha_m = \log\left(\frac{1-\varepsilon}{\varepsilon}\right) \\
                    \\
                    &\Longleftrightarrow \alpha_m = \frac{1}{2}\log\left(\frac{1-\varepsilon}{\varepsilon}\right) \\
                    \end{align}
                    \]
                </div>
                <p>
                    また、\(w_i^{(m)}=\dfrac{1}{N}e^{-y_iF_{m-1}(\boldsymbol{x}_i)}\) より
                </p>
                <div class="math">
                    \[
                    \begin{align}
                    w_i^{(m+1)}
                    &=\frac{1}{N}e^{-y_iF_{m}(\boldsymbol{x}_i)} \\
                    &=\frac{1}{N}e^{-y_i\{F_{m-1}(\boldsymbol{x}_i)+\alpha_mf_m(\boldsymbol{x}_i)\}} \\
                    &=\frac{1}{N}e^{-y_iF_{m-1}(\boldsymbol{x}_i)}e^{-y_i\alpha_mf_m(\boldsymbol{x}_i)} \\
                    &=w_i^{(m)}e^{-y_i\alpha_mf_m(\boldsymbol{x}_i)}
                    \end{align}
                    \]
                </div>
            </section>
        </main>
        <footer id="footer"></footer>
        <script src="../js/header.js"></script>
        <script src="../js/sidebar.js"></script>
        <script src="../js/footer.js"></script>
        <script src="../js/script.js"></script>
    </body>
</html>