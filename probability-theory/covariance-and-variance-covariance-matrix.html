<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>共分散・分散共分散行列</title>
        <link rel="stylesheet" href="../css/style.css">
        <script src="../js/mathjax.js"></script> 
    </head>
    <body>
        <header id="header"></header>
        <main id="contents">
            <h1>共分散・分散共分散行列</h1>
            <div id="table-of-contents"></div>
            <section id="1">
                <h2>共分散</h2>
                <p class="indent">
                    共分散は、2つの変数がどのように共に変化するかを表す統計量です。
                    「2つの変数が同じ方向に動く傾向があるか？」、「逆の方向に動く傾向があるか？」を測る指標です。
                </p>
                <figure class="def">
                    <figcaption>定義（共分散）</figcaption>
                    <p class="indent">
                        2つの確率変数 \(X,Y\) に対して
                    </p>
                    <div class="math">
                        \[
                        \operatorname{Cov}[X,Y]=E[(X-E[X])(Y-E[Y])]
                        \]
                    </div>
                    <p>
                        を \(X,Y\) の<strong>共分散</strong>という。
                    </p>
                </figure>
                <p class="indent">
                    つまり、「 \(X\) と \(Y\) が平均からどれだけずれているか」を掛け合わせた期待値です。
                    \(\operatorname{Cov}[X,Y]\) は \(\sigma_{XY}\) とも書かれます。
                </p>
                <figure class="th">
                    <figcaption>定理（共分散の性質）</figcaption>
                    <p class="indent">
                        \(X,Y\) を確率変数、\(a,b\in\mathbb{R}\) とすると、以下が成り立つ。
                    </p>
                    <ol>
                        <li>\(\operatorname{Cov}[aX,bY]=ab\operatorname{Cov}[X,Y]\)</li>
                        <li>\(\operatorname{Cov}[X+Z,Y]=\operatorname{Cov}[X,Y]+\operatorname{Cov}[Z,Y]\)</li>
                        <li>\(\operatorname{Cov}[X,Y]=E[XY]-E[X]E[Y]\)</li>
                        <li>\(X\) と \(Y\) が互いに独立ならば、\(\operatorname{Cov}[X,Y]=0\)</li>
                    </ol>
                </figure>
                <p class="indent">
                    (3) の性質は特に重要です。
                </p>
                <figure class="ex-problem">
                    <figcaption>例題</figcaption>
                    <p class="indent">
                        あるお店で、ある５日間の気温（℃）とアイスの売上（本）のデータが以下のように記録されている。
                    </p>
                    <table>
                        <tr><th>日にち</th><td>１日目</td><td>２日目</td><td>３日目</td><td>４日目</td><td>５日目</td></tr>
                        <tr><th>気温（℃）</th><td>20</td><td>22</td><td>25</td><td>23</td><td>21</td></tr>
                        <tr><th>アイスの売上（本）</th><td>30</td><td>35</td><td>45</td><td>40</td><td>33</td></tr>
                    </table>
                    <p class="indent">
                        気温 \(X\) とアイスの売上 \(Y\) の共分散 \(\mathrm{Cov}[X,Y]\) を求めよ。
                    </p>
                </figure>
                <p class="indent">
                    共分散は
                </p>
                <div class="math">
                    \[
                    \mathrm{Cov}[X,Y]=E[(X-E[X])(Y-E[Y])]
                    \]
                </div>
                <p>
                    なので、まず、期待値（平均） \(E[X],E[Y]\) を求めます。
                </p>
                <div class="math">
                    \[
                    E[X]=\frac{20+22+25+23+21}{5}=\frac{111}{5}=22.2
                    \]
                    \[
                    E[Y]=\frac{30+35+45+40+33}{5}=\frac{183}{5}=36.6
                    \]
                </div>
                <p>
                    よって
                </p>
                <div class="math">
                    \[
                    \begin{align}
                    \mathrm{Cov}[X,Y]&=E[(X-E[X])(Y-E[Y])]\\
                    &=E[(X-22.2)(Y-36.6)]\\
                    &=\frac{1}{5}\{(20-22.2)(30-36.6)+(22-22.2)(35-36.6)+(25-22.2)(45-36.6)+(23-22.2)(40-36.6)+(21-22.2)(33-36.6)\}\\
                    &=\frac{1}{5}\{(-2.2)(-6.6)+(-0.2)(-1.6)+(2.8)(8.4)+(0.8)(3.4)+(-1.2)(-3.6)\}\\
                    &=\frac{1}{5}(14.52+0.32+23.52+2.72+4.32)\\
                    &=\frac{45.4}{5}\\
                    &=9.08
                    \end{align}
                    \]
                </div>
                <p>
                    と求まります。
                </p>
                <p class="indent">
                    あるいは公式
                </p>
                <div class="math">
                    \[
                    \mathrm{Cov}[X,Y]=E[XY]-E[X]E[Y]
                    \]
                </div>
                <p>
                    を使う方法もあります。この場合 \(E[XY]\) も求めます。
                </p>
                <div class="math">
                    \[
                    \begin{align}
                    E[XY]&=\frac{(20\cdot30)+(22\cdot35)+(25\cdot45)+(23\cdot40)+(21\cdot33)}{5}\\
                    &=\frac{600+770+1125+920+693}{5}\\
                    &=\frac{4108}{5}\\
                    &=821.6
                    \end{align}
                    \]
                </div>
                <p>
                    よって
                </p>
                <div class="math">
                    \[
                    \begin{align}
                    \mathrm{Cov}[X,Y]&=E[XY]-E[X]E[Y]\\
                    &=821.6-22.2\cdot36.6\\
                    &=9.08
                    \end{align}
                    \]
                </div>
                <p>
                    と同じ結果が得られます。こちらの方が簡単な場合が多く、おすすめです。
                </p>
            </section>
            <section id="2">
                <h2>分散共分散行列</h2>
                <figure class="th">
                    <figcaption>定理（分散共分散行列）</figcaption>
                    <p class="indent">
                        確率ベクトル \(\boldsymbol{X}\in\mathbb{R}^n\) に対して
                    </p>
                    <div class="math">
                        \[
                        \Sigma:=E\left[(\boldsymbol{X}-E[\boldsymbol{X}])(\boldsymbol{X}-E[\boldsymbol{X}])^\top\right]
                        \]
                    </div>
                    <p>
                        を \(\boldsymbol{X}\) の<strong>分散共分散行列</strong>という。
                    </p>
                </figure>
                <p class="indent">

                </p>
                <div class="math">
                    \[
                    \begin{align}
                    \Sigma&=
                    \begin{bmatrix}
                    E[(X_1-\mu_1)(X_1-\mu_1)] & E[(X_1-\mu_1)(X_2-\mu_2)] & \cdots & E[(X_1-\mu_1)(X_n-\mu_n)] \\
                    E[(X_2-\mu_2)(X_1-\mu_1)] & E[(X_2-\mu_2)(X_2-\mu_2)] & \cdots & E[(X_2-\mu_2)(X_n-\mu_n)] \\
                    \vdots & \vdots & \ddots & \vdots \\
                    E[(X_n-\mu_n)(X_1-\mu_1)] & E[(X_n-\mu_n)(X_2-\mu_2)] & \cdots & E[(X_n-\mu_n)(X_n-\mu_n)] \\
                    \end{bmatrix}\\
                    &=
                    \begin{bmatrix}
                    E[(X_1-\mu_1)^2] & E[(X_1-\mu_1)(X_2-\mu_2)] & \cdots & E[(X_1-\mu_1)(X_n-\mu_n)] \\
                    E[(X_2-\mu_2)(X_1-\mu_1)] & E[(X_2-\mu_2)^2] & \cdots & E[(X_2-\mu_2)(X_n-\mu_n)] \\
                    \vdots & \vdots & \ddots & \vdots \\
                    E[(X_n-\mu_n)(X_1-\mu_1)] & E[(X_n-\mu_n)(X_2-\mu_2)] & \cdots & E[(X_n-\mu_n)^2] \\
                    \end{bmatrix}\\
                    &=
                    \begin{bmatrix}
                    V[X_1] & \mathrm{Cov}[X_1,X_2] & \cdots & \mathrm{Cov}[X_1,X_n] \\
                    \mathrm{Cov}[X_2,X_1] & V[X_2] & \cdots & \mathrm{Cov}[X_2,X_n] \\
                    \vdots & \vdots & \ddots & \vdots \\
                    \mathrm{Cov}[X_n,X_1] & \mathrm{Cov}[X_n,X_2] & \cdots & V[X_n] \\
                    \end{bmatrix}
                    \end{align}
                    \]
                </div>
            </section>
        </main>
        <footer id="footer"></footer>
        <script src="../js/header.js"></script>
        <script src="../js/footer.js"></script>
        <script src="../js/script.js"></script>
    </body>
</html>